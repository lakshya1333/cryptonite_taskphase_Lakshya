# RSA

## Modular Exponentiation:
Modular exponentiation is an operation that is used extensively in cryptography and is normally written like:  2^10 mod 17 .
``` In Python there's a built-in operator for performing this operation: pow(base, exponent, modulus).```
To grab the flag, find the solution to 101^17 mod 22663
```19906.```

## Public Keys:
RSA encryption is modular exponentiation of a message with an exponent e and a modulus N which is normally a product of two primes: ```N=p⋅q```.
The most common value for e is 0x10001 or 65537.
"Encrypt" the number 12 using the exponent e=65537 and the primes p=17 and q=23. What number do you get as the ciphertext?
```bash
a = 12
e = 65537
p = 17
q = 23
k = p*q

encrypt = pow(a,e,k)
print(encrypt)
```

## Euler Tolerant:
RSA relies on the difficulty of the factorisation of the modulus N. If the prime factors can be deduced, then we can calculate the Euler totient of N 
and thus decrypt the ciphertext.
Euler's totient ϕ(N) = (p-1)*(q-1)
```bash
p = 857504083339712752489993810777
q = 1029224947942998075080348647219

et = (p-1)*(q-1)
print(et)
```

## Private Keys:
The private key d is used to decrypt ciphertexts created with the corresponding public key.
If RSA is implemented well, if you do not have the private key the fastest way to decrypt the ciphertext is to factorise the modulus which is very hard to do 
for large integers.
```In RSA, the private key is the modular multiplicative inverse of the exponent e modulo ϕ(N), Euler's totient of N.```
```private key d ≡ pow(e,−1) mod ϕ(N)?```
```bash
p = 857504083339712752489993810777
q = 1029224947942998075080348647219

e=65537
d = pow(e,-1,(p-1)*(q-1))
print(d)
```

## RSA Decryption:
```bash
N = 882564595536224140639625987659416029426239230804614613279163
e = 65537
private =  121832886702415731577073962957377780195510499965398469843281
c = 77578995801157823671636298847186723593814843845525223303932
ans = pow(c,private,N)
print(ans)
```

## RSA Signature:
Imagine you write a message m. You encrypt this message with your friend's public key: c = m^e modN.
To sign this message, you calculate the hash of the message: H(m) and "encrypt" this with your private key: S=H(m)^d modN.

```bash
from Crypto.Hash import SHA256
from Crypto.Util.number import bytes_to_long

N = 15216583654836731327639981224133918855895948374072384050848479908982286890731769486609085918857664046075375253168955058743185664390273058074450390236774324903305663479046566232967297765731625328029814055635316002591227570271271445226094919864475407884459980489638001092788574811554149774028950310695112688723853763743238753349782508121985338746755237819373178699343135091783992299561827389745132880022259873387524273298850340648779897909381979714026837172003953221052431217940632552930880000919436507245150726543040714721553361063311954285289857582079880295199632757829525723874753306371990452491305564061051059885803
d = 11175901210643014262548222473449533091378848269490518850474399681690547281665059317155831692300453197335735728459259392366823302405685389586883670043744683993709123180805154631088513521456979317628012721881537154107239389466063136007337120599915456659758559300673444689263854921332185562706707573660658164991098457874495054854491474065039621922972671588299315846306069845169959451250821044417886630346229021305410340100401530146135418806544340908355106582089082980533651095594192031411679866134256418292249592135441145384466261279428795408721990564658703903787956958168449841491667690491585550160457893350536334242689
m = "crypto{Immut4ble_m3ssag1ng}"
hash_object = SHA256.new(m.encode('utf-8'))
hash = bytes_to_long(hash_object.digest())
signature = pow(hash,d,N)
print(signature)
```

## Factoring:
These days, using primes that are at least 1024 bits long is recommended—multiplying two such 1024 primes gives you a modulus that is 2048 bits large. RSA with a 2048-bit modulus is called RSA-2048.
I used ```sympy``` to factorize it.
```bash
from sympy import factorint
number = 510143758735509025530880200653196460532653147
factors = factorint(number)
min = min(factors)
print(min)

output => 19704762736204164635843
```

## Inferious prime:
In this they gave a RSA script which had a question mark flag but acc to me is of no use. I was given a output.txt file where n was there so i factoize it got p and
q and did a normal procedure to get the flag.
```bash
from Crypto.Util.number import long_to_bytes
from sympy import factorint

n = 984994081290620368062168960884976209711107645166770780785733
e = 65537
ct = 948553474947320504624302879933619818331484350431616834086273
# nums = factorint(n)
# print(list(nums.keys()))
p = 1160939713152385063689030212503
q = 848445505077945374527983649411
phi = (p - 1) * (q - 1)
d = pow(e, -1, phi)

flag = pow(ct, d, n)
flagnew = long_to_bytes(flag)
print(flagnew)
```

## Monoprime:
This was easy when i factorize the number n i saw it was already a prime number so this time i took p as n only and for calculating phi i only did (p-1) and repeated the normal procedure to get the flag.
```bash
from Crypto.Util.number import long_to_bytes
from sympy import factorint
n = 171731371218065444125482536302245915415603318380280392385291836472299752747934607246477508507827284075763910264995326010251268493630501989810855418416643352631102434317900028697993224868629935657273062472544675693365930943308086634291936846505861203914449338007760990051788980485462592823446469606824421932591                                                 
e = 65537
ct = 161367550346730604451454756189028938964941280347662098798775466019463375610700074840105776873791605070092554650190486030367121011578171525759600774739890458414593857709994072516290998135846956596662071379067305011746842247628316996977338024343628757374524136260758515864509435302781735938531030576289086798942 
# nums = factorint(n)
# print(list(nums.keys()))
p = n
phi = (p-1)
d = pow(e,-1,phi)
flagnew = pow(ct,d,n)
flag = long_to_bytes(flagnew)
print(flag)
```

## Square eyes:
When i was factorizing i found that both p and q are same so i looked again at the formula and found as p^2 number is counted we need to remove p number so formula became p^2-p => p(p-1)
```bash
from Crypto.Util.number import long_to_bytes
from sympy import factorint
n = 535860808044009550029177135708168016201451343147313565371014459027743491739422885443084705720731409713775527993719682583669164873806842043288439828071789970694759080842162253955259590552283047728782812946845160334801782088068154453021936721710269050985805054692096738777321796153384024897615594493453068138341203673749514094546000253631902991617197847584519694152122765406982133526594928685232381934742152195861380221224370858128736975959176861651044370378539093990198336298572944512738570839396588590096813217791191895941380464803377602779240663133834952329316862399581950590588006371221334128215409197603236942597674756728212232134056562716399155080108881105952768189193728827484667349378091100068224404684701674782399200373192433062767622841264055426035349769018117299620554803902490432339600566432246795818167460916180647394169157647245603555692735630862148715428791242764799469896924753470539857080767170052783918273180304835318388177089674231640910337743789750979216202573226794240332797892868276309400253925932223895530714169648116569013581643192341931800785254715083294526325980247219218364118877864892068185905587410977152737936310734712276956663192182487672474651103240004173381041237906849437490609652395748868434296753449
e = 65537
ct = 222502885974182429500948389840563415291534726891354573907329512556439632810921927905220486727807436668035929302442754225952786602492250448020341217733646472982286222338860566076161977786095675944552232391481278782019346283900959677167026636830252067048759720251671811058647569724495547940966885025629807079171218371644528053562232396674283745310132242492367274184667845174514466834132589971388067076980563188513333661165819462428837210575342101036356974189393390097403614434491507672459254969638032776897417674577487775755539964915035731988499983726435005007850876000232292458554577437739427313453671492956668188219600633325930981748162455965093222648173134777571527681591366164711307355510889316052064146089646772869610726671696699221157985834325663661400034831442431209123478778078255846830522226390964119818784903330200488705212765569163495571851459355520398928214206285080883954881888668509262455490889283862560453598662919522224935145694435885396500780651530829377030371611921181207362217397805303962112100190783763061909945889717878397740711340114311597934724670601992737526668932871436226135393872881664511222789565256059138002651403875484920711316522536260604255269532161594824301047729082877262812899724246757871448545439896


# nums = factorint(n)
# print(nums)
p = 23148667521998097720857168827790771337662483716348435477360567409355026169165934446949809664595523770853897203103759106983985113264049057416908191166720008503275951625738975666019029172377653170602440373579593292576530667773951407647222757756437867216095193174201323278896027294517792607881861855264600525772460745259440301156930943255240915685718552334192230264780355799179037816026330705422484000086542362084006958158550346395941862383925942033730030004606360308379776255436206440529441711859246811586652746028418496020145441513037535475380962562108920699929022900677901988508936509354385660735694568216631382653107
q = p
phi = (p-1)*p
d = pow(e,-1,phi)
flagnew = pow(ct,d,n)
flag = long_to_bytes(flagnew).decode()
print(flag)
```

## ManyPrime:
